version: '2'
services:
  
  ### web servers

  a1-web-server:
    build: a1-web-server-nginx/
    image: andrewmacheret/a1-web-server-nginx
    ports:
      - 9999:80
    external_links:
      - chess
      - montyhall
      - vta-tracker
      - remote-apis
      - ascii-cow
  
  ### databases

  mysql:
    image: mysql:5.7
    environment:
      MYSQL_ROOT_PASSWORD: "${MYSQL_ROOT_PASSWORD}"
    ports:
      - "3306:3306"
    volumes:
      - ./store/mysql:/var/lib/mysql
    hostname: mysql

  mongo:
    image: mongo:3.2
    ports:
      - "27017:27017"
    volumes:
      - ./store/mongo:/data/db
    hostname: mongo

  ### functional servers

  chess:
    build: chess-server/
    image: andrewmacheret/chess-server

  montyhall:
    image: andrewmacheret/montyhall-server

  vta-tracker:
    build: vta-tracker-server/
    image: andrewmacheret/vta-tracker-server
    environment:
      MYSQL_ROOT_PASSWORD: "${MYSQL_ROOT_PASSWORD}"
    external_links:
      - mysql

  remote-apis:
    build: remote-apis/
    image: andrewmacheret/remote-apis

  ascii-cow:
    build: ascii-cow/
    image: andrewmacheret/ascii-cow
